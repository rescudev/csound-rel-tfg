% !TEX root = ../proyect.tex

\chapter{Cabbage: Guía de uso}

Cabbage es un IDE para el lenguaje Csound. Es de código abierto y está desarrollado por Rory Walsh.

Será el principal IDE que usaremos a lo largo de este documento puesto que además de contar con todas las comodidades necesarias para el funcionamiento del lenguaje, aporta además funcionalidades para crear interfaces gráficas para nuestro software de manera muy simple pero vistosa.

Se presenta el siguiente capítulo con la intención de dar una guía básica referencial de funcionamiento a la que acudir en caso de ser necesario durante el curso del resto de contenidos.

\section{Instalación de Cabbage}\label{sec:CabbageInst}

Cabbage puede instalarse en sistemas Windows, OSX y Linux. Posee incluso un instalador en versión beta para sistemas Android.

Pasos para la instalación en Windows y OSX:

\begin{itemize}
 \item Acudir a la página \url{https://cabbageaudio.com/download/} donde encontraremos los enlaces de descarga.
 \item Seleccionar la versión adecuada para nuestro sistema, en este caso Windows u OSX.
 
 \figura{0.6}{img/C.1-InstaVersion}{Versiones disponibles}{fig:InstCabbage}{}
  
 \item Ejecutamos el archivo descargado y seguimos los pasos de instalación. Para los instaladores de Windows y OSX se incluye una instalación automática del lenguaje Csound en nuestro sistema por lo que una vez instalado Cabbage todo estará listo para usar.
 \figura{0.6}{img/C.2-InstaPasos}{Pasos de la instalación}{fig:InstPasos}{}
 \item Por último podemos ejecutar el acceso directo que se instala automáticamente en nuestro escritorio y empezar a usar Csound. Como se observa, Csound tiene una instalación muy fácil en estos sistemas.
\end{itemize}

\section{Opciones del IDE}\label{sec:OpcionesCabbage}

La extensión de los archivos de código Csound es \textbf{.csd}. Por supuesto, Cabbage puede abrir y ejecutar estos archivos además de que podemos encontrar una enorme librería de ejemplos que trae la instalación del IDE por defecto:

  \figura{0.6}{img/C.3-CabbageEjemplos}{Ejemplos disponibles en el IDE}{fig:EjemplosCabbage}{}

\subsection{Creando un nuevo archivo}

Para crear un nuevo archivo .csd basta con clicar el icono correspondiente en la barra superior(el primero empezando por la izquierda) o clicando en \textbf{File\textgreater New Csound File}. Aparecerá una ventana con cuatro posibles opciones:

\figura{0.6}{img/C.4-CabbageNewFile}{Sintetizador, Efecto, Archivo Csound y VCV Rack}{fig:NewFileCabbage}{}

Se trata de cuatro plantillas que nos aporta Cabbage para facilitarnos el desarrollo de nuevos instrumentos, hablemos de cada una de estas opciones:

\begin{itemize}
 \item \textbf{Sintetizador}: Aporta el código fundamental de un teclado funcional sin efectos, del cual podemos partir como base para crear nuestros sintetizadores y añadir la serie de modificadores que deseemos.
 \item \textbf{Efecto}: Aporta el código de un efecto básico de ganancia. En base a este código podemos crear el efecto que deseemos para poder modificar a gusto las ondas de sonido generadas por nuestros instrumentos.
 \item \textbf{Archivo Csound}: Genera un archivo .csd completamente vacío, es la opción que escogeríamos si no tenemos predilección por las demás o si nuestro objetivo es crear un software no totalmente convencional a lo que suele verse en Csound.
 \item \textbf{VCV Rack}: Esta es la plantilla más novedosa hasta la fecha en Cabbage. Nos da facilidades para exportar nuestro código como módulos \textbf{VCV Rack} y al usarla genera el código base de un efecto de ganancia modular listo para ser exportado y usado en softwares de estación de trabajo digital (EAD) o (DAW) por sus siglas en inglés.
\end{itemize}


\section{La etiqueta \textless Cabbage\textgreater}\label{sec:CabbageInst}

A diferencia del resto de etiquetas, la etiqueta \textless Cabbage\textgreater es exclusiva al IDE y proporciona funcionalidades para el diseño de la interfaz de usuario. Veamos algunos de sus usos:

\subsection{Los Widgets}

Llamaremos a los diferentes elementos de interfaz gráfica que aporta Cabbage, widgets. Podemos dividirlos en dos tipos: interactivos (botones, sliders, barras de selección, etc...) y no interactivos (imágenes, indicadores, etc...).

Empecemos con un ejemplo de uso de un slider para comprender la sintaxis:

\codigofuente{TeX}{Ejemplo básico de un widget}{codigo/CabbageSyntax}

En nuestra figura vemos que para hacer uso de un widget empezamos por escribir su nombre identificativo de tipo, en este caso \textbf{rslider}. Mástarde podemos definir una serie de identificadores para personalizar nuetro widget. Para especificar la posición de nuestro widget y su tamaño usaremos \textbf{bounds(x, y, width, height)}. En el caso de nuestro ejemplo estamos posicionando nuestro slider en las coodernadas XY (10,10) y le estamos dando un tamaño de 100*100 píxeles.

Podemos usar también el identificador \textbf{range(min, max, value, skew, incr)}. Sus valores min y max marcan el mínimo y máximo valor del slider en cuestión, el resto de parámetros son opcionales. \textbf{value} indica el valor inicial del slider. \textbf{skew} puede usarse para determinar la salida de datos del slider de forma no lineal, su valor predeterminado es 1 pero al darle un valor por ejemplo de 0.5 conseguiríamos una salida de datos exponencial. \textbf{incr} determina el tamaño de los pasos incrementales que da el slider a usarlo, por ejemplo con un valor 0.4, de un valor cualquiera del slider a sus adyacentes habría necesariamente una distacia en valor a 0.4.

En nuestro ejemplo hemos creado un slider cuyo rango de valores va del 0 al 1 y cuyo valor inicial es 0.5.

\section{Algunos Widgets útiles}
Veamos algunos de los widgets más usados en Cabbage:
\subsection{Form}
El widget \textbf{Form} nos sirve para crear la ventana de nuestra interfaz de usuario. Sobre este widget colocaremos el resto de elementos de nuestra interfaz.
\figura{0.4}{img/C.6-formExample}{Widget: Form}{fig:NewFileCabbage}{}

Este es un ejemplo básico de \textbf{Form}:
\codigofuente{TeX}{Ejemplo de widget: Form}{codigo/FormEx}
Siendo \textbf{size()} el tamaño de la ventana, \textbf{caption()} el String que muestra la cabecera de la ventana, \textbf{pluginID()} el identificador del widget y \textbf{colour()} su color en formato rgb.

\pagebreak
\subsection{Check Box}
El widget \textbf{CheckBox} nos sirve para marcar una casilla que por ejemplo active y desactive la generación de una de las ondas de salida de nuestros instrumentos.
\figura{0.4}{img/C.7-CheckBox}{Widget: CheckBox}{fig:NewFileCabbage}{}

Este es un ejemplo básico de \textbf{CheckBox}:
\codigofuente{TeX}{Ejemplo de widget: CheckBox}{codigo/CheckBoxEx}
Siendo \textbf{bounds()} la posición y tamaño del widget en la ventana, \textbf{channel()} el identificador que vinculará el \textbf{checkBox} con una variable de nuestro código y \textbf{text()} El texto que aparece junto al \textbf{CheckBox} mientras esté y no esté pulsado.

\subsection{Button}
El widget \textbf{Button} crea un botón al que podemos dar cualquier tipo de uso como por ejemplo el de inicio de grabación o activación de algún instrumento desde un instante determinado.
\figura{0.4}{img/C.8-Button}{Widget: Button}{fig:NewFileCabbage}{}

Este es un ejemplo básico de \textbf{Button}:
\codigofuente{TeX}{Ejemplo de widget: Button}{codigo/ButtonEx}
Siendo sus funciones de funcionamiento análogo a lo visto previamente en el \textbf{CheckBox}.

\pagebreak
\subsection{Keyboard}
El widget \textbf{Keyboard} nos sirve para desplegar un teclado de formato occidental. Es realmente útil si queremos programar un instrumento sintetizador o si queremos tener una vía rápida de ejecutar samples de forma visual y práctica.
\figura{0.4}{img/C.9-Keyboard}{Widget: Keyboard}{fig:NewFileCabbage}{}

Este es un ejemplo básico de \textbf{Keyboard}:
\codigofuente{TeX}{Ejemplo de widget: Keyboard}{codigo/KeyboardEx}
Siendo \textbf{identchannel()} el identificador del widget respecto al código Csound de manera análoga al funcionamiento de \textbf{channel()}.

\subsection{Signal Display}
El widget \textbf{SignalDisplay} nos servirá, como su propio nombre indica, para mostrar señales de onda de manera visual.
\figura{0.4}{img/C.10-SignalDisplay}{Widget: Signal Display}{fig:NewFileCabbage}{}

Este es un ejemplo básico de \textbf{SignalDisplay}:
\codigofuente{TeX}{Ejemplo de widget: SignalDisplay}{codigo/SignalDisplayEx}
Siendo \textbf{displaytype()} el tipo de onda a mostrar de entre las siguientes opciones: 'spectrogram', 'spectroscope', 'waveform' y 'lissajous'. Y \textbf{signalvariable()} donde instroduciremos la variable con la onda que queremos que se muestre.

\section{Exportando nuestros instrumentos}\label{sec:ExportCabbage}

Una vez hemos terminado de programar el código de un instrumento, necesitamos alguna manera de hacer que ese código sea útil en el mundo real. Para ello Cabbage ofrece una serie de opciones de exportación del instrumento para que podamos usarlos donde queramos (ya sea sobre un software de terceros o de forma unitaria) y saquemos provecho de ellos.

Estas son las opciones de exportación de Cabbage:

\figura{0.6}{img/C.5-CabbageExport}{Las opciones de exportación del IDE}{fig:ExportCabbage}{}

En primer lugar averigüemos qué es un \textbf{VST}: 

Un plugin \textbf{VST} (\textbf{Virtual Studio Technology}) es una interfaz, en este caso digital, capaz de simular un instrumento o aportar un módulo entrada/salida para añadir efectos de sonido. Para usar un \textbf{VST} necesitamos un software compatible con este formato que sirva de base y desde el que ejecutemos nuestro \textbf{VST}. 
También es interesante destacar que \textbf{VST3} es el formato más moderno de \textbf{VST} con un código fuente más robusto y de fiar. El cual es también una de las opciones de exportación de Cabbage.

Será nuestro estándar de exportación, aunque Cabbage ofrece otras opciones como:

\begin{itemize}
 \item \textbf{VCV RackModule}: Siendo parecido al formato VST, es el tipo de módulo del que hablábamos en la sección de plantillas de creación de archivos en Cabbage. Es un formato de código abierto con una amplia comunidad y una documentación robusta en su web \url{https://vcvrack.com/Fundamental}
 \item \textbf{Standalone application}: Para generar un archivo ejecutable .exe que podremos usar en cualquier momento siempre y cuando tengamos Cabbage instalado en el equipo. Es interesante si por ejemplo codificamos un instrumento que pueda usarse como tal sin necesidad de otros softwares como un teclado digital.
 \item \textbf{FMOD Sound Plugin}: El formato usados por FMOD, \textbf{https://www.fmod.com/} y que está dedicado a la composición de sonido para juegos. Usando este formato, podremos generar plugins directamente compatibles con FMOD Studio.
\end{itemize}

En cualquier caso, Cabbage generará los archivos convenientes de exportación incluidos archivos .csd y .dll en el caso de sistemas windows. Será importante que mantengamos todos los archivos generados para un instrumento en el mismo directorio y así evitemos conflictos en la ejecución.


